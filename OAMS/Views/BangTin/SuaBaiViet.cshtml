@{
    ViewBag.Title = "SoanBaiViet";
    Layout = "~/Views/Shared/_LayoutMes.cshtml";
}

@section Css{
    <link rel="stylesheet" href="~/Content/assetsmes/css/bootstrap-datepicker3.min.css" />
}

@section Scripts{
    <script src="~/MyScript/bangtin/QuanLyCtrl.js"></script>
    <script src="~/Content/assetsmes/js/chosen.jquery.min.js"></script>
    <script src="~/Content/assetsmes/js/spinbox.min.js"></script>
    <script src="~/Content/assetsmes/js/bootstrap-datepicker.min.js"></script>
    <script src="~/Content/assetsmes/js/bootstrap-timepicker.min.js"></script>
    <script src="~/Content/assetsmes/js/moment.min.js"></script>
    <script src="~/Content/assetsmes/js/daterangepicker.min.js"></script>
    <script src="~/Content/assetsmes/js/bootstrap-datetimepicker.min.js"></script>
    <script src="~/Content/assetsmes/js/bootstrap-colorpicker.min.js"></script>
    <script src="~/Content/assetsmes/js/jquery.knob.min.js"></script>
    <script src="~/Content/assetsmes/js/autosize.min.js"></script>
    <script src="~/Content/assetsmes/js/jquery.inputlimiter.min.js"></script>
    <script src="~/Content/assetsmes/js/jquery.maskedinput.min.js"></script>
    <script src="~/Content/assetsmes/js/bootstrap-tag.min.js"></script>
    <script src="~/Content/assetsmes/js/markdown.min.js"></script>
    <script src="~/Content/assetsmes/js/bootstrap-markdown.min.js"></script>
    <script src="~/Content/assetsmes/js/jquery.hotkeys.index.min.js"></script>
    <script src="~/Content/assetsmes/js/bootstrap-wysiwyg.min.js"></script>
    <script src="~/Content/assetsmes/js/bootbox.js"></script>
}

@section ScriptsCode{
    <script type="text/javascript">
        jQuery(function ($) {
            $('#simple-colorpicker-1').ace_colorpicker({ pull_right: true }).on('change', function () {
                var color_class = $(this).find('option:selected').data('class');
                var new_class = 'widget-box';
                if (color_class != 'default') new_class += ' widget-color-' + color_class;
                $(this).closest('.widget-box').attr('class', new_class);
            });


            // scrollables
            $('.scrollable').each(function () {
                var $this = $(this);
                $(this).ace_scroll({
                    size: $this.attr('data-size') || 100,
                    //styleClass: 'scroll-left scroll-margin scroll-thin scroll-dark scroll-light no-track scroll-visible'
                });
            });

            $('.scrollable-horizontal').each(function () {
                var $this = $(this);
                $(this).ace_scroll(
                    {
                        horizontal: true,
                        styleClass: 'scroll-top',//show the scrollbars on top(default is bottom)
                        size: $this.attr('data-size') || 500,
                        mouseWheelLock: true
                    }
                ).css({ 'padding-top': 12 });
            });

            $(window).on('resize.scroll_reset', function () {
                $('.scrollable-horizontal').ace_scroll('reset');
            });


            $('#id-checkbox-vertical').prop('checked', false).on('click', function () {
                $('#widget-toolbox-1').toggleClass('toolbox-vertical')
                    .find('.btn-group').toggleClass('btn-group-vertical')
                    .filter(':first').toggleClass('hidden')
                    .parent().toggleClass('btn-toolbar')
            });

            /**
            //or use slimScroll plugin
            $('.slim-scrollable').each(function () {
                var $this = $(this);
                $this.slimScroll({
                    height: $this.data('height') || 100,
                    railVisible:true
                });
            });
            */


            /**$('.widget-box').on('setting.ace.widget' , function(e) {
                e.preventDefault();
            });*/

            /**
            $('.widget-box').on('show.ace.widget', function(e) {
                //e.preventDefault();
                //this = the widget-box
            });
            $('.widget-box').on('reload.ace.widget', function(e) {
                //this = the widget-box
            });
            */

            //$('#my-widget-box').widget_box('hide');

            //when a widget is shown/hidden/closed, we save its state for later retrieval
            $(document).on('shown.ace.widget hidden.ace.widget closed.ace.widget', '.widget-box', function (event) {
                var widgets = ace.data.get('demo', 'widget-state', true);
                if (widgets == null) widgets = {}

                var id = $(this).attr('id');
                widgets[id] = event.type;
                ace.data.set('demo', 'widget-state', widgets, null, true);
            });

            $('[data-rel=tooltip]').tooltip();


            (function () {
                //restore widget order
                var container_list = ace.data.get('demo', 'widget-order', true);
                if (container_list) {
                    for (var container_id in container_list) if (container_list.hasOwnProperty(container_id)) {

                        var widgets_inside_container = container_list[container_id];
                        if (widgets_inside_container.length == 0) continue;

                        for (var i = 0; i < widgets_inside_container.length; i++) {
                            var widget = widgets_inside_container[i];
                            $('#' + widget).appendTo('#' + container_id);
                        }

                    }
                }


                //restore widget state
                var widgets = ace.data.get('demo', 'widget-state', true);
                if (widgets != null) {
                    for (var id in widgets) if (widgets.hasOwnProperty(id)) {
                        var state = widgets[id];
                        var widget = $('#' + id);
                        if
                        (
                            (state == 'shown' && widget.hasClass('collapsed'))
                            ||
                            (state == 'hidden' && !widget.hasClass('collapsed'))
                        ) {
                            widget.widget_box('toggleFast');
                        }
                        else if (state == 'closed') {
                            widget.widget_box('closeFast');
                        }
                    }
                }


                $('#main-widget-container').removeClass('invisible');


                //reset saved positions and states
                $('#reset-widgets').on('click', function () {
                    ace.data.remove('demo', 'widget-state');
                    ace.data.remove('demo', 'widget-order');
                    document.location.reload();
                });

            })();

        });
    </script>

    <script type="text/javascript">
        jQuery(function ($) {
            $('#id-disable-check').on('click', function () {
                var inp = $('#form-input-readonly').get(0);
                if (inp.hasAttribute('disabled')) {
                    inp.setAttribute('readonly', 'true');
                    inp.removeAttribute('disabled');
                    inp.value = "This text field is readonly!";
                }
                else {
                    inp.setAttribute('disabled', 'disabled');
                    inp.removeAttribute('readonly');
                    inp.value = "This text field is disabled!";
                }
            });


            if (!ace.vars['touch']) {
                $('.chosen-select').chosen({ allow_single_deselect: true });
                //resize the chosen on window resize

                $(window)
                    .off('resize.chosen')
                    .on('resize.chosen', function () {
                        $('.chosen-select').each(function () {
                            var $this = $(this);
                            $this.next().css({ 'width': $this.parent().width() });
                        })
                    }).trigger('resize.chosen');
                //resize chosen on sidebar collapse/expand
                $(document).on('settings.ace.chosen', function (e, event_name, event_val) {
                    if (event_name != 'sidebar_collapsed') return;
                    $('.chosen-select').each(function () {
                        var $this = $(this);
                        $this.next().css({ 'width': $this.parent().width() });
                    })
                });


                $('#chosen-multiple-style .btn').on('click', function (e) {
                    var target = $(this).find('input[type=radio]');
                    var which = parseInt(target.val());
                    if (which == 2) $('#form-field-select-4').addClass('tag-input-style');
                    else $('#form-field-select-4').removeClass('tag-input-style');
                });
            }


            $('[data-rel=tooltip]').tooltip({ container: 'body' });
            $('[data-rel=popover]').popover({ container: 'body' });

            autosize($('textarea[class*=autosize]'));

            $('textarea.limited').inputlimiter({
                remText: '%n character%s remaining...',
                limitText: 'max allowed : %n.'
            });

            $.mask.definitions['~'] = '[+-]';
            $('.input-mask-date').mask('99/99/9999');
            $('.input-mask-phone').mask('(999) 999-9999');
            $('.input-mask-eyescript').mask('~9.99 ~9.99 999');
            $(".input-mask-product").mask("a*-999-a999", { placeholder: " ", completed: function () { alert("You typed the following: " + this.val()); } });



            $("#input-size-slider").css('width', '200px').slider({
                value: 1,
                range: "min",
                min: 1,
                max: 8,
                step: 1,
                slide: function (event, ui) {
                    var sizing = ['', 'input-sm', 'input-lg', 'input-mini', 'input-small', 'input-medium', 'input-large', 'input-xlarge', 'input-xxlarge'];
                    var val = parseInt(ui.value);
                    $('#form-field-4').attr('class', sizing[val]).attr('placeholder', '.' + sizing[val]);
                }
            });

            $("#input-span-slider").slider({
                value: 1,
                range: "min",
                min: 1,
                max: 12,
                step: 1,
                slide: function (event, ui) {
                    var val = parseInt(ui.value);
                    $('#form-field-5').attr('class', 'col-xs-' + val).val('.col-xs-' + val);
                }
            });



            //"jQuery UI Slider"
            //range slider tooltip example
            $("#slider-range").css('height', '200px').slider({
                orientation: "vertical",
                range: true,
                min: 0,
                max: 100,
                values: [17, 67],
                slide: function (event, ui) {
                    var val = ui.values[$(ui.handle).index() - 1] + "";

                    if (!ui.handle.firstChild) {
                        $("<div class='tooltip right in' style='display:none;left:16px;top:-6px;'><div class='tooltip-arrow'></div><div class='tooltip-inner'></div></div>")
                            .prependTo(ui.handle);
                    }
                    $(ui.handle.firstChild).show().children().eq(1).text(val);
                }
            }).find('span.ui-slider-handle').on('blur', function () {
                $(this.firstChild).hide();
            });


            $("#slider-range-max").slider({
                range: "max",
                min: 1,
                max: 10,
                value: 2
            });

            $("#slider-eq > span").css({ width: '90%', 'float': 'left', margin: '15px' }).each(function () {
                // read initial values from markup and remove that
                var value = parseInt($(this).text(), 10);
                $(this).empty().slider({
                    value: value,
                    range: "min",
                    animate: true

                });
            });

            $("#slider-eq > span.ui-slider-purple").slider('disable');//disable third item


            $('#id-input-file-1 , #id-input-file-2').ace_file_input({
                no_file: 'No File ...',
                btn_choose: 'Choose',
                btn_change: 'Change',
                droppable: false,
                onchange: null,
                thumbnail: false //| true | large
                //whitelist:'gif|png|jpg|jpeg'
                //blacklist:'exe|php'
                //onchange:''
                //
            });
            //pre-show a file name, for example a previously selected file
            //$('#id-input-file-1').ace_file_input('show_file_list', ['myfile.txt'])


            $('#id-input-file-3').ace_file_input({
                style: 'well',
                btn_choose: 'Drop files here or click to choose',
                btn_change: null,
                no_icon: 'ace-icon fa fa-cloud-upload',
                droppable: true,
                thumbnail: 'small'//large | fit
                //,icon_remove:null//set null, to hide remove/reset button
                /**,before_change:function(files, dropped) {
                    //Check an example below
                    //or examples/file-upload.html
                    return true;
                }*/
                /**,before_remove : function() {
                    return true;
                }*/
                ,
                preview_error: function (filename, error_code) {
                    //name of the file that failed
                    //error_code values
                    //1 = 'FILE_LOAD_FAILED',
                    //2 = 'IMAGE_LOAD_FAILED',
                    //3 = 'THUMBNAIL_FAILED'
                    //alert(error_code);
                }

            }).on('change', function () {
                //console.log($(this).data('ace_input_files'));
                //console.log($(this).data('ace_input_method'));
            });


            //$('#id-input-file-3')
            //.ace_file_input('show_file_list', [
            //{type: 'image', name: 'name of image', path: 'http://path/to/image/for/preview'},
            //{type: 'file', name: 'hello.txt'}
            //]);




            //dynamically change allowed formats by changing allowExt && allowMime function
            $('#id-file-format').removeAttr('checked').on('change', function () {
                var whitelist_ext, whitelist_mime;
                var btn_choose
                var no_icon
                if (this.checked) {
                    btn_choose = "Drop images here or click to choose";
                    no_icon = "ace-icon fa fa-picture-o";

                    whitelist_ext = ["jpeg", "jpg", "png", "gif", "bmp"];
                    whitelist_mime = ["image/jpg", "image/jpeg", "image/png", "image/gif", "image/bmp"];
                }
                else {
                    btn_choose = "Drop files here or click to choose";
                    no_icon = "ace-icon fa fa-cloud-upload";

                    whitelist_ext = null;//all extensions are acceptable
                    whitelist_mime = null;//all mimes are acceptable
                }
                var file_input = $('#id-input-file-3');
                file_input
                    .ace_file_input('update_settings',
                        {
                            'btn_choose': btn_choose,
                            'no_icon': no_icon,
                            'allowExt': whitelist_ext,
                            'allowMime': whitelist_mime
                        })
                file_input.ace_file_input('reset_input');

                file_input
                    .off('file.error.ace')
                    .on('file.error.ace', function (e, info) {
                        //console.log(info.file_count);//number of selected files
                        //console.log(info.invalid_count);//number of invalid files
                        //console.log(info.error_list);//a list of errors in the following format

                        //info.error_count['ext']
                        //info.error_count['mime']
                        //info.error_count['size']

                        //info.error_list['ext']  = [list of file names with invalid extension]
                        //info.error_list['mime'] = [list of file names with invalid mimetype]
                        //info.error_list['size'] = [list of file names with invalid size]


                        /**
                        if( !info.dropped ) {
                            //perhapse reset file field if files have been selected, and there are invalid files among them
                            //when files are dropped, only valid files will be added to our file array
                            e.preventDefault();//it will rest input
                        }
                        */


                        //if files have been selected (not dropped), you can choose to reset input
                        //because browser keeps all selected files anyway and this cannot be changed
                        //we can only reset file field to become empty again
                        //on any case you still should check files with your server side script
                        //because any arbitrary file can be uploaded by user and it's not safe to rely on browser-side measures
                    });


                /**
                file_input
                .off('file.preview.ace')
                .on('file.preview.ace', function(e, info) {
                    console.log(info.file.width);
                    console.log(info.file.height);
                    e.preventDefault();//to prevent preview
                });
                */

            });

            $('#spinner1').ace_spinner({ value: 0, min: 0, max: 200, step: 10, btn_up_class: 'btn-info', btn_down_class: 'btn-info' })
                .closest('.ace-spinner')
                .on('changed.fu.spinbox', function () {
                    //console.log($('#spinner1').val())
                });
            $('#spinner2').ace_spinner({ value: 0, min: 0, max: 10000, step: 100, touch_spinner: true, icon_up: 'ace-icon fa fa-caret-up bigger-110', icon_down: 'ace-icon fa fa-caret-down bigger-110' });
            $('#spinner3').ace_spinner({ value: 0, min: -100, max: 100, step: 10, on_sides: true, icon_up: 'ace-icon fa fa-plus bigger-110', icon_down: 'ace-icon fa fa-minus bigger-110', btn_up_class: 'btn-success', btn_down_class: 'btn-danger' });
            $('#spinner4').ace_spinner({ value: 0, min: -100, max: 100, step: 10, on_sides: true, icon_up: 'ace-icon fa fa-plus', icon_down: 'ace-icon fa fa-minus', btn_up_class: 'btn-purple', btn_down_class: 'btn-purple' });

            //$('#spinner1').ace_spinner('disable').ace_spinner('value', 11);
            //or
            //$('#spinner1').closest('.ace-spinner').spinner('disable').spinner('enable').spinner('value', 11);//disable, enable or change value
            //$('#spinner1').closest('.ace-spinner').spinner('value', 0);//reset to 0


            //datepicker plugin
            //link
            $('.date-picker').datepicker({
                autoclose: true,
                todayHighlight: true
            })
                //show datepicker when clicking on the icon
                .next().on(ace.click_event, function () {
                    $(this).prev().focus();
                });

            //or change it into a date range picker
            $('.input-daterange').datepicker({ autoclose: true });


            //to translate the daterange picker, please copy the "examples/daterange-fr.js" contents here before initialization
            $('input[name=date-range-picker]').daterangepicker({
                'applyClass': 'btn-sm btn-success',
                'cancelClass': 'btn-sm btn-default',
                locale: {
                    applyLabel: 'Apply',
                    cancelLabel: 'Cancel',
                }
            })
                .prev().on(ace.click_event, function () {
                    $(this).next().focus();
                });


            $('#timepicker1').timepicker({
                minuteStep: 1,
                showSeconds: true,
                showMeridian: false,
                disableFocus: true,
                icons: {
                    up: 'fa fa-chevron-up',
                    down: 'fa fa-chevron-down'
                }
            }).on('focus', function () {
                $('#timepicker1').timepicker('showWidget');
            }).next().on(ace.click_event, function () {
                $(this).prev().focus();
            });




            if (!ace.vars['old_ie']) $('#date-timepicker1').datetimepicker({
                //format: 'MM/DD/YYYY h:mm:ss A',//use this option to display seconds
                icons: {
                    time: 'fa fa-clock-o',
                    date: 'fa fa-calendar',
                    up: 'fa fa-chevron-up',
                    down: 'fa fa-chevron-down',
                    previous: 'fa fa-chevron-left',
                    next: 'fa fa-chevron-right',
                    today: 'fa fa-arrows ',
                    clear: 'fa fa-trash',
                    close: 'fa fa-times'
                }
            }).next().on(ace.click_event, function () {
                $(this).prev().focus();
            });


            $('#colorpicker1').colorpicker();
            //$('.colorpicker').last().css('z-index', 2000);//if colorpicker is inside a modal, its z-index should be higher than modal'safe

            $('#simple-colorpicker-1').ace_colorpicker();
            //$('#simple-colorpicker-1').ace_colorpicker('pick', 2);//select 2nd color
            //$('#simple-colorpicker-1').ace_colorpicker('pick', '#fbe983');//select #fbe983 color
            //var picker = $('#simple-colorpicker-1').data('ace_colorpicker')
            //picker.pick('red', true);//insert the color if it doesn't exist


            $(".knob").knob();


            var tag_input = $('#form-field-tags');
            try {
                tag_input.tag(
                    {
                        placeholder: tag_input.attr('placeholder'),
                        //enable typeahead by specifying the source array
                        source: ace.vars['US_STATES'],//defined in ace.js >> ace.enable_search_ahead
                        /**
                        //or fetch data from database, fetch those that match "query"
                        source: function(query, process) {
                          $.ajax({url: 'remote_source.php?q='+encodeURIComponent(query)})
                          .done(function(result_items){
                            process(result_items);
                          });
                        }
                        */
                    }
                )

                //programmatically add/remove a tag
                var $tag_obj = $('#form-field-tags').data('tag');
                $tag_obj.add('Programmatically Added');

                var index = $tag_obj.inValues('some tag');
                $tag_obj.remove(index);
            }
            catch (e) {
                //display a textarea for old IE, because it doesn't support this plugin or another one I tried!
                tag_input.after('<textarea id="' + tag_input.attr('id') + '" name="' + tag_input.attr('name') + '" rows="3">' + tag_input.val() + '</textarea>').remove();
                //autosize($('#form-field-tags'));
            }


            /////////
            $('#modal-form input[type=file]').ace_file_input({
                style: 'well',
                btn_choose: 'Drop files here or click to choose',
                btn_change: null,
                no_icon: 'ace-icon fa fa-cloud-upload',
                droppable: true,
                thumbnail: 'large'
            })

            //chosen plugin inside a modal will have a zero width because the select element is originally hidden
            //and its width cannot be determined.
            //so we set the width after modal is show
            $('#modal-form').on('shown.bs.modal', function () {
                if (!ace.vars['touch']) {
                    $(this).find('.chosen-container').each(function () {
                        $(this).find('a:first-child').css('width', '210px');
                        $(this).find('.chosen-drop').css('width', '210px');
                        $(this).find('.chosen-search input').css('width', '200px');
                    });
                }
            })
            /**
            //or you can activate the chosen plugin after modal is shown
            //this way select element becomes visible with dimensions and chosen works as expected
            $('#modal-form').on('shown', function () {
                $(this).find('.modal-chosen').chosen();
            })
            */



            $(document).one('ajaxloadstart.page', function (e) {
                autosize.destroy('textarea[class*=autosize]')

                $('.limiterBox,.autosizejs').remove();
                $('.daterangepicker.dropdown-menu,.colorpicker.dropdown-menu,.bootstrap-datetimepicker-widget.dropdown-menu').remove();
            });

        });
    </script>

    <script type="text/javascript">
        jQuery(function ($) {

            $('textarea[data-provide="markdown"]').each(function () {
                var $this = $(this);

                if ($this.data('markdown')) {
                    $this.data('markdown').showEditor();
                }
                else $this.markdown()

                $this.parent().find('.btn').addClass('btn-white');
            })



            function showErrorAlert(reason, detail) {
                var msg = '';
                if (reason === 'unsupported-file-type') { msg = "Unsupported format " + detail; }
                else {
                    //console.log("error uploading file", reason, detail);
                }
                $('<div class="alert"> <button type="button" class="close" data-dismiss="alert">&times;</button>' +
                    '<strong>File upload error</strong> ' + msg + ' </div>').prependTo('#alerts');
            }

            //$('#editor1').ace_wysiwyg();//this will create the default editor will all buttons

            //but we want to change a few buttons colors for the third style
            $('#editor1').ace_wysiwyg({
                toolbar:
                    [
                        'font',
                        null,
                        'fontSize',
                        null,
                        { name: 'bold', className: 'btn-info' },
                        { name: 'italic', className: 'btn-info' },
                        { name: 'strikethrough', className: 'btn-info' },
                        { name: 'underline', className: 'btn-info' },
                        null,
                        { name: 'insertunorderedlist', className: 'btn-success' },
                        { name: 'insertorderedlist', className: 'btn-success' },
                        { name: 'outdent', className: 'btn-purple' },
                        { name: 'indent', className: 'btn-purple' },
                        null,
                        { name: 'justifyleft', className: 'btn-primary' },
                        { name: 'justifycenter', className: 'btn-primary' },
                        { name: 'justifyright', className: 'btn-primary' },
                        { name: 'justifyfull', className: 'btn-inverse' },
                        null,
                        { name: 'createLink', className: 'btn-pink' },
                        { name: 'unlink', className: 'btn-pink' },
                        null,
                        { name: 'insertImage', className: 'btn-success' },
                        null,
                        'foreColor',
                        null,
                        { name: 'undo', className: 'btn-grey' },
                        { name: 'redo', className: 'btn-grey' }
                    ],
                'wysiwyg': {
                    fileUploadError: showErrorAlert
                }
            }).prev().addClass('wysiwyg-style2');


            /**
            //make the editor have all the available height
            $(window).on('resize.editor', function() {
                var offset = $('#editor1').parent().offset();
                var winHeight =  $(this).height();

                $('#editor1').css({'height':winHeight - offset.top - 10, 'max-height': 'none'});
            }).triggerHandler('resize.editor');
            */


            $('#editor2').css({ 'height': '200px' }).ace_wysiwyg({
                toolbar_place: function (toolbar) {
                    return $(this).closest('.widget-box')
                        .find('.widget-header').prepend(toolbar)
                        .find('.wysiwyg-toolbar').addClass('inline');
                },
                toolbar:
                    [
                        'bold',
                        { name: 'italic', title: 'Change Title!', icon: 'ace-icon fa fa-leaf' },
                        'strikethrough',
                        null,
                        'insertunorderedlist',
                        'insertorderedlist',
                        null,
                        'justifyleft',
                        'justifycenter',
                        'justifyright'
                    ],
                speech_button: false
            });




            $('[data-toggle="buttons"] .btn').on('click', function (e) {
                var target = $(this).find('input[type=radio]');
                var which = parseInt(target.val());
                var toolbar = $('#editor1').prev().get(0);
                if (which >= 1 && which <= 4) {
                    toolbar.className = toolbar.className.replace(/wysiwyg\-style(1|2)/g, '');
                    if (which == 1) $(toolbar).addClass('wysiwyg-style1');
                    else if (which == 2) $(toolbar).addClass('wysiwyg-style2');
                    if (which == 4) {
                        $(toolbar).find('.btn-group > .btn').addClass('btn-white btn-round');
                    } else $(toolbar).find('.btn-group > .btn-white').removeClass('btn-white btn-round');
                }
            });




            //RESIZE IMAGE

            //Add Image Resize Functionality to Chrome and Safari
            //webkit browsers don't have image resize functionality when content is editable
            //so let's add something using jQuery UI resizable
            //another option would be opening a dialog for user to enter dimensions.
            if (typeof jQuery.ui !== 'undefined' && ace.vars['webkit']) {

                var lastResizableImg = null;
                function destroyResizable() {
                    if (lastResizableImg == null) return;
                    lastResizableImg.resizable("destroy");
                    lastResizableImg.removeData('resizable');
                    lastResizableImg = null;
                }

                var enableImageResize = function () {
                    $('.wysiwyg-editor')
                        .on('mousedown', function (e) {
                            var target = $(e.target);
                            if (e.target instanceof HTMLImageElement) {
                                if (!target.data('resizable')) {
                                    target.resizable({
                                        aspectRatio: e.target.width / e.target.height,
                                    });
                                    target.data('resizable', true);

                                    if (lastResizableImg != null) {
                                        //disable previous resizable image
                                        lastResizableImg.resizable("destroy");
                                        lastResizableImg.removeData('resizable');
                                    }
                                    lastResizableImg = target;
                                }
                            }
                        })
                        .on('click', function (e) {
                            if (lastResizableImg != null && !(e.target instanceof HTMLImageElement)) {
                                destroyResizable();
                            }
                        })
                        .on('keydown', function () {
                            destroyResizable();
                        });
                }

                enableImageResize();

                /**
                //or we can load the jQuery UI dynamically only if needed
                if (typeof jQuery.ui !== 'undefined') enableImageResize();
                else {//load jQuery UI if not loaded
                    //in Ace demo ./components will be replaced by correct components path
                    $.getScript("assets/js/jquery-ui.custom.min.js", function(data, textStatus, jqxhr) {
                        enableImageResize()
                    });
                }
                */
            }


        });
    </script>
}

<div ng-controller="adminBT" ng-init="InitSua(@ViewBag.MaTinTuc)">
    <div class="breadcrumbs breadcrumbs-fixed" id="breadcrumbs">
        <ul class="breadcrumb">
            <li>
                <i class="ace-icon fa fa-home home-icon"></i>
                <a href="~/Home">FSM</a>
            </li>
            <li class="active">Bảng Tin</li>
        </ul><!-- /.breadcrumb -->

        <div class="nav-search" id="nav-search">
            <form class="form-search">
                <span class="input-icon">
                    <input type="text" placeholder="Search ..." class="nav-search-input" id="nav-search-input" autocomplete="off" />
                    <i class="ace-icon fa fa-search nav-search-icon"></i>
                </span>
            </form>
        </div>
    </div>

    <div id="mescontent" class="page-content">
        <div class="page-header">
            <h1>
                Tin Tức
                <small>
                    <i class="ace-icon fa fa-angle-double-right"></i>
                    Sửa Thông Tin Bài Viết
                </small>
            </h1>
        </div>

        <div id="id-message-list-navbar" class="message-navbar clearfix">
            <div class="message-bar">
                <div class="message-infobar" id="id-message-infobar">
                    <span class="blue bigger-150">Sửa Bài Viết</span>
                </div>
            </div>

            <div>
                <div class="messagebar-item-left">
                    <a href="@Url.Action("QuanLy","BangTin")" class="btn-back-message-list">
                        <i class="ace-icon fa fa-arrow-left bigger-110 middle blue"></i>
                        <b class="middle bigger-110">Quản Lý</b>
                    </a>
                </div>

                <div class="messagebar-item-right">
                    <span class="inline btn-send-message">
                        <a href="@Url.Action("Index", "BangTin")" class="btn btn-sm btn-primary no-border btn-white btn-round">
                            <span class="bigger-110">Trang Chủ</span>

                            <i class="ace-icon fa fa-arrow-right icon-on-right"></i>
                        </a>
                    </span>
                </div>
            </div>
        </div>

        <div class="message-list-container">
            <form id="id-message-form" class="form-horizontal message-form col-xs-12">
                <div>
                    @*Tiêu đề*@
                    <div class="form-group">
                        <label class="col-sm-3 control-label no-padding-right" for="form-field-recipient">Tiêu Đề:</label>

                        <div class="col-sm-7 col-xs-12">
                            <div class="input-icon block col-xs-12 no-padding">
                                <input type="text" ng-model="TTBV.TieuDe" class="col-xs-12" name="subject" id="form-field-subject" placeholder="Tiêu đề bài viết">
                                <i class="ace-icon fa fa-comment-o"></i>
                            </div>
                            <div>
                                <span class="help-inline">
                                    <label class="middle">
                                        <input class="ace" type="checkbox" ng-model="TTBV.TinNoiBat" />
                                        <span class="lbl">
                                            <span class="text-danger">
                                                <a title="Tin được chọn là Tin quan trọng là tin được đưa được lên trang chủ tại thanh chạy chữ ngang."
                                                   data-rel="tooltip" href="#" data-placement="bottom">
                                                    Tin Quan Trọng
                                                </a>
                                            </span>
                                        </span>
                                    </label>
                                </span>

                                <span class="help-inline">
                                    <label class="middle">
                                        <input class="ace" type="checkbox" ng-model="objThem.HienThi" ng-click="checkPermission()" />
                                        <span class="lbl">
                                            <span class="text-danger">
                                                <a title="Bạn sẽ được duyệt ngay tin này nếu bạn đã được cấp quyền"
                                                   data-rel="tooltip" href="#" data-placement="bottom">
                                                    Duyệt Tin Này
                                                </a>
                                            </span>
                                        </span>
                                    </label>
                                </span>
                            </div>
                        </div>
                    </div>
                    @*/Tiêu đề*@
                    <div class="hr hr-18 dotted"></div>

                    @*Loại Tin*@
                    <div class="form-group">
                        <label class="col-sm-3 control-label no-padding-right" for="form-field-recipient">Loại Tin:</label>

                        <div class="col-sm-3">
                            <span class="input-icon">
                                <select class="form-control"
                                        id="form-field-select-1"
                                        ng-model="MaLoaiTin"
                                        ng-options="item as item.Ten for item in DsLoaiTin track by item.MaLoaiTin"></select>
                            </span>
                        </div>
                    </div>
                    @*/Loại Tin*@
                    <div class="hr hr-18 dotted"></div>

                    @*Ngày Hết Hạn*@
                    <div class="form-group">
                        <label class="col-sm-3 control-label no-padding-right" for="form-field-recipient">Ngày Hết Hạn:</label>
                        <div class="col-sm-3">
                            <span class="input-icon">
                                <span class="input-group">
                                    <input class="form-control date-picker" id="nhhSua" type="text" data-date-format="dd-mm-yyyy" readonly />
                                    <span class="input-group-addon">
                                        <i class="fa fa-calendar bigger-110"></i>
                                    </span>
                                </span>
                            </span>
                            <p><i>Tin được chọn là Tin quan trọng là tin được đưa được lên trang chủ tại thanh chạy chữ ngang</i></p>
                        </div>
                    </div>
                    @*/Ngày Hết Hạn*@
                    <div class="hr hr-18 dotted"></div>

                    @*Ngày Hết Hạn Tin Mới*@
                    <div class="form-group">
                        <label class="col-sm-3 control-label no-padding-right" for="form-field-recipient">Ngày Hết Hạn Tin Mới:</label>
                        <div class="col-sm-3">
                            <span class="input-icon">
                                <span class="input-group">
                                    <input class="form-control date-picker" id="nhhtmSua" type="text" data-date-format="dd-mm-yyyy" readonly />
                                    <span class="input-group-addon">
                                        <i class="fa fa-calendar bigger-110"></i>
                                    </span>
                                </span>
                            </span>
                            <p><i>Nếu thiết lập ngày hết hạn tin mới thì tin sẽ có biểu tượng 'NEW MÀU ĐỎ' cho đến hết ngày đó</i></p>
                        </div>
                    </div>
                    @*/Ngày Hết Hạn Tin Mới*@
                    <div class="hr hr-18 dotted"></div>

                    @*Ngày Hết Hạn Trang Chủ*@
                    <div class="form-group">
                        <label class="col-sm-3 control-label no-padding-right" for="form-field-recipient">Ngày Hết Hạn Trang Chủ:</label>
                        <div class="col-sm-3">
                            <span class="input-icon">
                                <span class="input-group">
                                    <input class="form-control date-picker" id="nhhtcSua" type="text" data-date-format="dd-mm-yyyy" readonly />
                                    <span class="input-group-addon">
                                        <i class="fa fa-calendar bigger-110"></i>
                                    </span>
                                </span>
                            </span>
                            <p><i>Nếu thiết lập ngày hết hạn trang chủ thì tin sẽ chay trên trang chủ cho đến hết ngày đó</i></p>
                        </div>
                    </div>
                    @*/Ngày Hết Hạn Trang Chủ*@
                    <div class="hr hr-18 dotted"></div>

                    @*Mô tả*@
                    <div class="form-group">
                        <label class="col-sm-3 control-label no-padding-right" for="form-field-subject">Mô Tả Ngắn:</label>

                        <div class="col-sm-7 col-xs-12">
                            <div class="input-icon block col-xs-12 no-padding">
                                <textarea type="text" ng-model="TTBV.MoTa" class="col-xs-12" name="subject" id="form-field-subject" placeholder="Mô tả ngắn về bài viết"></textarea>
                            </div>
                        </div>
                    </div>
                    @*/Mô tả*@
                    <div class="hr hr-18 dotted"></div>

                    @*Nội Dung*@
                    <div class="form-group">
                        <label class="col-sm-3 control-label no-padding-right">
                            <span class="inline space-24 hidden-480"></span>
                            Nội Dung:
                        </label>

                        <div class="col-sm-9">
                            <div class="wysiwyg-editor" id="editor1"></div>
                        </div>
                    </div>
                    @*Nội Dung*@
                    <div class="hr hr-18 dotted"></div>

                    @*Hình Ảnh*@
                    <div class="form-group no-margin-bottom">
                        <label class="col-sm-3 control-label no-padding-right">Ảnh Đại Diện:</label>

                        <div class="col-sm-4">
                            <input type="file" class="form-control" id="id-input-file-2" nv-file-select uploader="uploaderImage" filters="upImg" />
                            <ul class="attachment-list pull-left list-unstyled">
                                @*Hình ảnh từ csdl*@
                                <li ng-show="TTBV.HinhAnh != null">
                                    <a href="~/Content/image/{{TTBV.HinhAnh}}" class="attached-file" target="_blank">
                                        <i class="ace-icon fa fa-file-o bigger-110"></i>
                                        <span class="attached-name">{{TTBV.HinhAnh}}</span>
                                    </a>

                                    <span class="action-buttons">
                                        <a href="#">
                                            <i class="ace-icon fa fa-check bigger-125 green"></i>
                                        </a>

                                        <a href="#" ng-click="xoaHinh($event,TTBV.MaTinTuc)">
                                            <i class="ace-icon fa fa-trash-o bigger-125 red"></i>
                                        </a>
                                    </span>
                                </li>
                                @*/Hình ảnh từ csdl*@

                                @*Hình ảnh từ queue*@
                                <li ng-show="ttIm">
                                    <a href="#" class="attached-file">
                                        <i class="ace-icon fa fa-file-o bigger-110"></i>
                                        <span class="attached-name">{{HinhAnh.file.name}} ({{HinhAnh.file.size}} KB)</span>
                                    </a>

                                    <span class="action-buttons">
                                        <a href="#" ng-click="uploadImg(HinhAnh)" ng-show="ttImg">
                                            <i class="ace-icon fa fa-upload bigger-125 blue"></i>
                                        </a>

                                        <a href="#" ng-click="removeImg()" ng-show="ttImg">
                                            <i class="ace-icon fa fa-trash-o bigger-125 red"></i>
                                        </a>

                                        @*<a href="#" ng-show="!ttImg">
                                            <i class="ace-icon fa fa-check bigger-125 green"></i>
                                        </a>*@
                                    </span>
                                </li>
                                @*/Hình ảnh từ queue*@
                            </ul>
                        </div>
                    </div>
                    @*Hình Ảnh*@
                    <div class="hr hr-18 dotted"></div>

                    @*Tập Tin Đính Kèm*@
                    <div class="form-group no-margin-bottom">
                        <label class="col-sm-3 control-label no-padding-right">Tin Đính Kèm:</label>

                        <div class="col-sm-4">
                            <input type="file" class="form-control" id="id-input-file-2" nv-file-select uploader="uploaderFile" filters="upFile" />
                            <ul class="attachment-list pull-left list-unstyled">
                                @*Tập tin từ csdl*@
                                <li ng-repeat="item in TTBV.TapTinDinhKem">
                                    <a href="~/Content/attachment/{{item.Ten}}" class="attached-file" target="_blank">
                                        <i class="ace-icon fa fa-file-o bigger-110"></i>
                                        <span class="attached-name">{{item.Ten}}</span>
                                    </a>

                                    <span class="action-buttons" @*id="ttFile{{$index}}"*@>
                                        @*<a href="#" ng-click="uploadfile(item)">
                                                <i class="ace-icon fa fa-upload bigger-125 blue"></i>
                                            </a>*@

                                        <a href="#">
                                            <i class="ace-icon fa fa-check bigger-125 green"></i>
                                        </a>

                                        <a href="#" ng-click="xoaFile($event,item.MaTapTin)">
                                            <i class="ace-icon fa fa-trash-o bigger-125 red"></i>
                                        </a>
                                    </span>
                                </li>
                                @*/Tập tin từ csdl*@

                                @*Tập tin từ queue*@
                                <li ng-repeat="item in uploaderFile.queue">
                                    <a href="#" class="attached-file" target="_blank">
                                        <i class="ace-icon fa fa-file-o bigger-110"></i>
                                        <span class="attached-name">{{item.file.name}}</span>
                                    </a>

                                    <span class="action-buttons" @*id="ttFile{{$index}}"*@>
                                        <a href="#" ng-click="uploadfile(item)">
                                            <i class="ace-icon fa fa-upload bigger-125 blue"></i>
                                        </a>

                                        @*<a href="#">
                                                <i class="ace-icon fa fa-check bigger-125 green"></i>
                                            </a>*@

                                        <a href="#" @*ng-click="removeFile(item)"*@>
                                            <i class="ace-icon fa fa-trash-o bigger-125 red"></i>
                                        </a>
                                    </span>
                                </li>
                                @*/Tập tin từ queue*@
                            </ul>
                        </div>
                    </div>
                    @*/Tập Tin Đính Kèm*@

                    <div class="align-right">
                        <button class="btn btn-sm btn-success">
                            <i class="ace-icon fa fa-check bigger-140"></i>
                            Sửa Bài Viết
                        </button>
                    </div>

                    <div class="hr hr-18 dotted"></div>
                </div>
            </form>
        </div>
    </div>
</div>

